!function(){var e=/iphone|ipad|ipod/i.test(window.navigator.userAgent.toLowerCase());if(e){console={};console.log=function(v){var iframe=document.createElement("iframe");iframe.setAttribute("src","ios-log: "+v);document.documentElement.appendChild(iframe);iframe.parentNode.removeChild(iframe);iframe=null};console.debug=console.info=console.warn=console.error=console.log}}(),function(){var that=window.mraid={};var _this=window.FlyMobMraid={nativeSDKFiredReady:false,nativeCallQueue:[],nativeCallInFlight:false,lastSizeChangeProperties:null};_this.fireChangeEvent=function(rows){var i;for(i in rows){if(rows.hasOwnProperty(i)){var callback=handle[i];callback(rows[i])}}};_this.nativeCallComplete=function(dataAndEvents){if(0===this.nativeCallQueue.length){return void(this.nativeCallInFlight=false)}var path=this.nativeCallQueue.pop();window.location=path};_this.executeNativeCall=function(b){var file=b.shift();if(!this.nativeSDKFiredReady){return console.log("rejecting "+file+" because mraid is not ready"),void _this.notifyErrorEvent("mraid is not ready",file)}var c;var encodedValue;var path="mraid://"+file;var o=true;var j=0;for(;j<b.length;j+=2){c=b[j];encodedValue=b[j+1];if(null!==encodedValue){if(o){path+="?";o=false}else{path+="&"}path+=encodeURIComponent(c)+"="+encodeURIComponent(encodedValue)}}if(this.nativeCallInFlight){this.nativeCallQueue.push(path)}else{this.nativeCallInFlight=true;window.location=path}};_this.setCurrentPosition=function(position,moveY,w,rowHeight){result={x:position,y:moveY,width:w,height:rowHeight};callback(self.INFO,"Set current position to "+emit(result))};_this.setDefaultPosition=function(moveX,moveY,w,rowHeight){cfg={x:moveX,y:moveY,width:w,height:rowHeight};callback(self.INFO,"Set default position to "+emit(cfg))};_this.setMaxSize=function(w,h){metrics={width:w,height:h};obj.width=w;obj.height=h;callback(self.INFO,"Set max size to "+emit(metrics))};_this.setPlacementType=function(textAlt){text=textAlt;callback(self.INFO,"Set placement type to "+emit(text))};_this.setScreenSize=function(width,height){data={width:width,height:height};callback(self.INFO,"Set screen size to "+emit(data))};_this.setState=function(values){value=values;callback(self.INFO,"Set state to "+emit(value));callback(self.STATECHANGE,value)};_this.setIsViewable=function(results){user=results;callback(self.INFO,"Set isViewable to "+emit(user));callback(self.VIEWABLECHANGE,user)};_this.setSupports=function(dataAndEvents,tel,calendar,deepDataAndEvents,ignoreMethodDoesntExist){intercepted={sms:dataAndEvents,tel:tel,calendar:calendar,storePicture:deepDataAndEvents,inlineVideo:ignoreMethodDoesntExist}};_this.notifyReadyEvent=function(){this.nativeSDKFiredReady=true;callback(self.READY)};_this.notifyErrorEvent=function(mongoObject,arg){callback(self.ERROR,mongoObject,arg)};_this.fireReadyEvent=_this.notifyReadyEvent;_this.fireErrorEvent=_this.notifyErrorEvent;_this.notifySizeChangeEvent=function(r,arg){if(!(this.lastSizeChangeProperties&&(r==this.lastSizeChangeProperties.width&&arg==this.lastSizeChangeProperties.height))){this.lastSizeChangeProperties={width:r,height:arg};callback(self.SIZECHANGE,r,arg)}};_this.notifyStateChangeEvent=function(){if(value===choice.LOADING){callback(self.INFO,"Native SDK initialized.")}callback(self.INFO,"Set state to "+emit(value));callback(self.STATECHANGE,value)};_this.notifyViewableChangeEvent=function(){callback(self.INFO,"Set isViewable to "+emit(user));callback(self.VIEWABLECHANGE,user)};var choice=(that.VERSION="2.0",that.STATES={LOADING:"loading",DEFAULT:"default",EXPANDED:"expanded",HIDDEN:"hidden",RESIZED:"resized"});var self=that.EVENTS={ERROR:"error",INFO:"info",READY:"ready",STATECHANGE:"stateChange",VIEWABLECHANGE:"viewableChange",SIZECHANGE:"sizeChange"};var firstChild=that.PLACEMENT_TYPES={UNKNOWN:"unknown",INLINE:"inline",INTERSTITIAL:"interstitial"};var obj={width:false,height:false,useCustomClose:false,isModal:true};var img={width:false,height:false,offsetX:false,offsetY:false,customClosePosition:"top-right",allowOffscreen:true};var node={allowOrientationChange:true,forceOrientation:"none"};var intercepted={sms:false,tel:false,calendar:false,storePicture:false,inlineVideo:false};var metrics={};var result={};var cfg={};var data={};var p=false;var events={};var value=choice.LOADING;var user=false;var text=firstChild.UNKNOWN;var Map=function(ev){this.event=ev;this.count=0;var obj={};this.add=function(value){var key=String(value);if(!obj[key]){obj[key]=value;this.count++}};this.remove=function(arg){var keyName=String(arg);return obj[keyName]?(obj[keyName]=null,delete obj[keyName],this.count--,true):false};this.removeAll=function(){var i;for(i in obj){if(obj.hasOwnProperty(i)){this.remove(obj[i])}}};this.broadcast=function(data){var prop;for(prop in obj){if(obj.hasOwnProperty(prop)){obj[prop].apply(that,data)}}};this.toString=function(){var result=[ev,":"];var p;for(p in obj){if(obj.hasOwnProperty(p)){result.push("|",p,"|")}}return result.join("")}};var callback=function(){var data=new Array(arguments.length);var l=arguments.length;var i=0;for(;l>i;i++){data[i]=arguments[i]}var index=data.shift();if(events[index]){events[index].broadcast(data)}};var func=function(name,key){var i;for(i in key){if(key[i]===name){return true}}return false};var emit=function(data){if("object"==typeof data){var queryParams=[];if(data.push){var key;for(key in data){queryParams.push(data[key])}return"["+queryParams.join(",")+"]"}for(key in data){queryParams.push("'"+key+"': "+data[key])}return"{"+queryParams.join(",")+"}"}return String(data)};var handle={state:function(key){if(value===choice.LOADING){callback(self.INFO,"Native SDK initialized.")}value=key;callback(self.INFO,"Set state to "+emit(key));callback(self.STATECHANGE,value)},viewable:function(result){user=result;callback(self.INFO,"Set isViewable to "+emit(result));callback(self.VIEWABLECHANGE,user)},placementType:function(data){callback(self.INFO,"Set placementType to "+emit(data));text=data},sizeChange:function(tests){callback(self.INFO,"Set screenSize to "+emit(tests));var testName;for(testName in tests){if(tests.hasOwnProperty(testName)){data[testName]=tests[testName]}}},supports:function(type){callback(self.INFO,"Set supports to "+emit(type));intercepted=type}};var configure=function(what,s,obj,dataAndEvents){if(!dataAndEvents){if(null===what){return callback(self.ERROR,"Required object not provided.",obj),false}var i;for(i in s){if(s.hasOwnProperty(i)&&void 0===what[i]){return callback(self.ERROR,"Object is missing required property: "+i,obj),false}}}var type;for(type in what){var c=s[type];var d=what[type];if(c&&!c(d)){return callback(self.ERROR,"Value of property "+type+" is invalid: "+d,obj),false}}return true};var name={useCustomClose:function(val){return"boolean"==typeof val}};that.addEventListener=function(name,type){if(name&&type){if(func(name,self)){if(!events[name]){events[name]=new Map(name)}events[name].add(type)}else{callback(self.ERROR,"Unknown MRAID event: "+name,"addEventListener")}}else{callback(self.ERROR,"Both event and listener are required.","addEventListener")}};that.close=function(){if(value===choice.HIDDEN){callback(self.ERROR,"Ad cannot be closed when it is already hidden.","close")}else{_this.executeNativeCall(["close"])}};that.expand=function(dest){if(this.getState()!==choice.DEFAULT&&this.getState()!==choice.RESIZED){callback(self.ERROR,"Ad can only be expanded from the default or resized state.","expand")}else{var args=["expand","shouldUseCustomClose",obj.useCustomClose];if(dest){args=args.concat(["url",dest])}_this.executeNativeCall(args)}};that.getExpandProperties=function(){var end={width:obj.width,height:obj.height,useCustomClose:obj.useCustomClose,isModal:obj.isModal};return end};that.getCurrentPosition=function(){return{x:result.x,y:result.y,width:result.width,height:result.height}};that.getDefaultPosition=function(){return{x:cfg.x,y:cfg.y,width:cfg.width,height:cfg.height}};that.getMaxSize=function(){return{width:metrics.width,height:metrics.height}};that.getPlacementType=function(){return text};that.getScreenSize=function(){return{width:data.width,height:data.height}};that.getState=function(){return value};that.isViewable=function(){return user};that.getVersion=function(){return that.VERSION};that.open=function(opt_async){if(opt_async){_this.executeNativeCall(["open","url",opt_async])}else{callback(self.ERROR,"URL is required.","open")}};that.removeEventListener=function(event,handler){if(!event){return void callback(self.ERROR,"Event is required.","removeEventListener")}if(handler){var pos=false;if(events[event]&&(pos=events[event].remove(handler)),!pos){return void callback(self.ERROR,"Listener not currently registered for event.","removeEventListener")}}else{if(!handler){if(events[event]){events[event].removeAll()}}}if(events[event]){if(0===events[event].count){events[event]=null;delete events[event]}}};that.setExpandProperties=function(options){if(configure(options,name,"setExpandProperties",true)){if(options.hasOwnProperty("useCustomClose")){obj.useCustomClose=options.useCustomClose}}};that.useCustomClose=function(id){obj.useCustomClose=id;p=true;_this.executeNativeCall(["usecustomclose","shouldUseCustomClose",id])};that.createCalendarEvent=function(args){options.initialize(args);if(options.parse()){_this.executeNativeCall(options.arguments)}else{callback(self.ERROR,options.errors[0],"createCalendarEvent")}};that.supports=function(method){return intercepted[method]};that.playVideo=function(err){return that.isViewable()?void(err?_this.executeNativeCall(["playVideo","uri",err]):callback(self.ERROR,"playVideo must be called with a valid URI","playVideo")):void callback(self.ERROR,"playVideo cannot be called until the ad is viewable","playVideo")};that.storePicture=function(err){return that.isViewable()?void(err?_this.executeNativeCall(["storePicture","uri",err]):callback(self.ERROR,"storePicture must be called with a valid URI","storePicture")):void callback(self.ERROR,"storePicture cannot be called until the ad is viewable","storePicture")};var actual={width:function(s){return!isNaN(s)&&s>0},height:function(s){return!isNaN(s)&&s>0},offsetX:function(val2){return!isNaN(val2)},offsetY:function(val2){return!isNaN(val2)},customClosePosition:function(line){return"string"==typeof line&&["top-right","bottom-right","top-left","bottom-left","center","top-center","bottom-center"].indexOf(line)>-1},allowOffscreen:function(val){return"boolean"==typeof val}};that.setOrientationProperties=function(o){if(o.hasOwnProperty("allowOrientationChange")){node.allowOrientationChange=o.allowOrientationChange}if(o.hasOwnProperty("forceOrientation")){node.forceOrientation=o.forceOrientation}var oldconfig=["setOrientationProperties","allowOrientationChange",node.allowOrientationChange,"forceOrientation",node.forceOrientation];_this.executeNativeCall(oldconfig)};that.getOrientationProperties=function(){return{allowOrientationChange:node.allowOrientationChange,forceOrientation:node.forceOrientation}};that.resize=function(){if(this.getState()!==choice.DEFAULT&&this.getState()!==choice.RESIZED){callback(self.ERROR,"Ad can only be resized from the default or resized state.","resize")}else{if(img.width&&img.height){var oldconfig=["resize","width",img.width,"height",img.height,"offsetX",img.offsetX||0,"offsetY",img.offsetY||0,"customClosePosition",img.customClosePosition,"allowOffscreen",!!img.allowOffscreen];_this.executeNativeCall(oldconfig)}else{callback(self.ERROR,"Must set resize properties before calling resize()","resize")}}};that.getResizeProperties=function(){var end={width:img.width,height:img.height,offsetX:img.offsetX,offsetY:img.offsetY,customClosePosition:img.customClosePosition,allowOffscreen:img.allowOffscreen};return end};that.setResizeProperties=function(properties){if(configure(properties,actual,"setResizeProperties",true)){var props=["width","height","offsetX","offsetY","customClosePosition","allowOffscreen"];var l=props.length;var i=0;for(;l>i;i++){var prop=props[i];if(properties.hasOwnProperty(prop)){img[prop]=properties[prop]}}}};var options={initialize:function(params){this.parameters=params;this.errors=[];this.arguments=["createCalendarEvent"]},parse:function(){if(this.parameters){this.parseDescription();this.parseLocation();this.parseSummary();this.parseStartAndEndDates();this.parseReminder();this.parseRecurrence();this.parseTransparency()}else{this.errors.push("The object passed to createCalendarEvent cannot be null.")}var cnl=this.errors.length;return cnl&&(this.arguments.length=0),0===cnl},parseDescription:function(){this._processStringValue("description")},parseLocation:function(){this._processStringValue("location")},parseSummary:function(){this._processStringValue("summary")},parseStartAndEndDates:function(){this._processDateValue("start");this._processDateValue("end")},parseReminder:function(){var cDigit=this._getParameter("reminder");if(cDigit){if(0>cDigit){this.arguments.push("relativeReminder");this.arguments.push(parseInt(cDigit)/1E3)}else{this.arguments.push("absoluteReminder");this.arguments.push(cDigit)}}},parseRecurrence:function(){var which=this._getParameter("recurrence");if(which){this.parseRecurrenceInterval(which);this.parseRecurrenceFrequency(which);this.parseRecurrenceEndDate(which);this.parseRecurrenceArrayValue(which,"daysInWeek");this.parseRecurrenceArrayValue(which,"daysInMonth");this.parseRecurrenceArrayValue(which,"daysInYear");this.parseRecurrenceArrayValue(which,"monthsInYear")}},parseTransparency:function(){var camelKey=["opaque","transparent"];if(this.parameters.hasOwnProperty("transparency")){var modId=this.parameters.transparency;if(func(modId,camelKey)){this.arguments.push("transparency");this.arguments.push(modId)}else{this.errors.push("transparency must be opaque or transparent")}}},parseRecurrenceArrayValue:function(object,key){if(object.hasOwnProperty(key)){var value=object[key];if(value&&value instanceof Array){var copies=value.join(",");this.arguments.push(key);this.arguments.push(copies)}else{this.errors.push(key+" must be an array.")}}},parseRecurrenceInterval:function(object){if(object.hasOwnProperty("interval")){var copies=object.interval;if(copies){this.arguments.push("interval");this.arguments.push(copies)}else{this.errors.push("Recurrence interval cannot be null.")}}else{this.arguments.push("interval");this.arguments.push(1)}},parseRecurrenceFrequency:function(o){if(o.hasOwnProperty("frequency")){var name=o.frequency;var camelKey=["daily","weekly","monthly","yearly"];if(func(name,camelKey)){this.arguments.push("frequency");this.arguments.push(name)}else{this.errors.push('Recurrence frequency must be one of: "daily", "weekly", "monthly", "yearly".')}}},parseRecurrenceEndDate:function(object){var copies=object.expires;if(copies){this.arguments.push("expires");this.arguments.push(copies)}},_getParameter:function(name){return this.parameters.hasOwnProperty(name)?this.parameters[name]:null},_processStringValue:function(property){if(this.parameters.hasOwnProperty(property)){var initialValue=this.parameters[property];this.arguments.push(property);this.arguments.push(initialValue)}},_processDateValue:function(item){if(this.parameters.hasOwnProperty(item)){var copies=this._getParameter(item);this.arguments.push(item);this.arguments.push(copies)}}}}();